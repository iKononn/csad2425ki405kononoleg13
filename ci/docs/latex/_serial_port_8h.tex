\doxysection{D\+:/csad2425ki405kononoleg13/src/client/client/\+Serial\+Port.h File Reference}
\hypertarget{_serial_port_8h}{}\label{_serial_port_8h}\index{D:/csad2425ki405kononoleg13/src/client/client/SerialPort.h@{D:/csad2425ki405kononoleg13/src/client/client/SerialPort.h}}


Contains functions for serial port communication in Windows.  


{\ttfamily \#include $<$windows.\+h$>$}\newline
{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$fstream$>$}\newline
{\ttfamily \#include $<$string$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{_serial_port_8h_ae883446ccd8e3d1c49440f2579d89dc0}{CBR\+\_\+9600}}~9600
\begin{DoxyCompactList}\small\item\em Baud rates constants for serial communication. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{_serial_port_8h_aa8dfd552cc13c9770f4178c28cfa2109}{CBR\+\_\+19200}}~19200
\item 
\#define \mbox{\hyperlink{_serial_port_8h_a354e1d2d7ec134fdd59906a0849ff44a}{CBR\+\_\+115200}}~115200
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
HANDLE \mbox{\hyperlink{_serial_port_8h_aba21005ba55eaa15063aace08745f537}{open\+Serial\+Port}} (const wstring \&port\+Name, DWORD baud\+Rate)
\begin{DoxyCompactList}\small\item\em Opens a serial port with specified settings. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{_serial_port_8h_a7e10a8858a30f45b39bc1b18904c5a15}{send\+Message}} (HANDLE h\+Serial, const string \&message)
\begin{DoxyCompactList}\small\item\em Sends a message to the serial port. \end{DoxyCompactList}\item 
string \mbox{\hyperlink{_serial_port_8h_a0c12408163c930823d6efa5dc4095533}{read\+Message}} (HANDLE h\+Serial)
\begin{DoxyCompactList}\small\item\em Reads a message from the serial port. \end{DoxyCompactList}\item 
wstring \mbox{\hyperlink{_serial_port_8h_ad2b6dc672019e23dab7d591991aeaef1}{select\+Port}} ()
\begin{DoxyCompactList}\small\item\em Prompts the user to select a COM port. \end{DoxyCompactList}\item 
DWORD \mbox{\hyperlink{_serial_port_8h_a127cadd593a5af64e10d94488978920b}{select\+Baud\+Rate}} ()
\begin{DoxyCompactList}\small\item\em Prompts the user to select a baud rate for serial communication. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains functions for serial port communication in Windows. 



\doxysubsection{Macro Definition Documentation}
\Hypertarget{_serial_port_8h_a354e1d2d7ec134fdd59906a0849ff44a}\index{SerialPort.h@{SerialPort.h}!CBR\_115200@{CBR\_115200}}
\index{CBR\_115200@{CBR\_115200}!SerialPort.h@{SerialPort.h}}
\doxysubsubsection{\texorpdfstring{CBR\_115200}{CBR\_115200}}
{\footnotesize\ttfamily \label{_serial_port_8h_a354e1d2d7ec134fdd59906a0849ff44a} 
\#define CBR\+\_\+115200~115200}

\Hypertarget{_serial_port_8h_aa8dfd552cc13c9770f4178c28cfa2109}\index{SerialPort.h@{SerialPort.h}!CBR\_19200@{CBR\_19200}}
\index{CBR\_19200@{CBR\_19200}!SerialPort.h@{SerialPort.h}}
\doxysubsubsection{\texorpdfstring{CBR\_19200}{CBR\_19200}}
{\footnotesize\ttfamily \label{_serial_port_8h_aa8dfd552cc13c9770f4178c28cfa2109} 
\#define CBR\+\_\+19200~19200}

\Hypertarget{_serial_port_8h_ae883446ccd8e3d1c49440f2579d89dc0}\index{SerialPort.h@{SerialPort.h}!CBR\_9600@{CBR\_9600}}
\index{CBR\_9600@{CBR\_9600}!SerialPort.h@{SerialPort.h}}
\doxysubsubsection{\texorpdfstring{CBR\_9600}{CBR\_9600}}
{\footnotesize\ttfamily \label{_serial_port_8h_ae883446ccd8e3d1c49440f2579d89dc0} 
\#define CBR\+\_\+9600~9600}



Baud rates constants for serial communication. 



\doxysubsection{Function Documentation}
\Hypertarget{_serial_port_8h_aba21005ba55eaa15063aace08745f537}\index{SerialPort.h@{SerialPort.h}!openSerialPort@{openSerialPort}}
\index{openSerialPort@{openSerialPort}!SerialPort.h@{SerialPort.h}}
\doxysubsubsection{\texorpdfstring{openSerialPort()}{openSerialPort()}}
{\footnotesize\ttfamily \label{_serial_port_8h_aba21005ba55eaa15063aace08745f537} 
HANDLE open\+Serial\+Port (\begin{DoxyParamCaption}\item[{const wstring \&}]{port\+Name}{, }\item[{DWORD}]{baud\+Rate}{}\end{DoxyParamCaption})}



Opens a serial port with specified settings. 


\begin{DoxyParams}{Parameters}
{\em port\+Name} & The name of the port to open (e.\+g., "{}\+COM1"{}). \\
\hline
{\em baud\+Rate} & The baud rate for the serial communication (e.\+g., 9600, 115200).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
HANDLE Handle to the opened serial port, or INVALID\+\_\+\+HANDLE\+\_\+\+VALUE if the operation fails.
\end{DoxyReturn}
This function initializes the serial port with the specified port name and baud rate. It configures the communication parameters such as baud rate, byte size, stop bits, and parity. The function also sets timeouts for read and write operations.


\begin{DoxyParams}{Parameters}
{\em port\+Name} & The name of the port to open (e.\+g., "{}\+COM1"{}). \\
\hline
{\em baud\+Rate} & The baud rate for the serial communication (e.\+g., 9600, 115200).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
HANDLE Handle to the opened serial port, or INVALID\+\_\+\+HANDLE\+\_\+\+VALUE if the operation fails. 
\end{DoxyReturn}
\Hypertarget{_serial_port_8h_a0c12408163c930823d6efa5dc4095533}\index{SerialPort.h@{SerialPort.h}!readMessage@{readMessage}}
\index{readMessage@{readMessage}!SerialPort.h@{SerialPort.h}}
\doxysubsubsection{\texorpdfstring{readMessage()}{readMessage()}}
{\footnotesize\ttfamily \label{_serial_port_8h_a0c12408163c930823d6efa5dc4095533} 
string read\+Message (\begin{DoxyParamCaption}\item[{HANDLE}]{h\+Serial}{}\end{DoxyParamCaption})}



Reads a message from the serial port. 


\begin{DoxyParams}{Parameters}
{\em h\+Serial} & Handle to the serial port.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string The message read from the serial port.
\end{DoxyReturn}
This function reads data from the serial port and stores it in a buffer. It waits until a newline character ({\ttfamily \textbackslash{}n}) is encountered, indicating the end of the message. The message is then returned as a {\ttfamily string}.


\begin{DoxyParams}{Parameters}
{\em h\+Serial} & Handle to the serial port.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string The message read from the serial port. 
\end{DoxyReturn}
\Hypertarget{_serial_port_8h_a127cadd593a5af64e10d94488978920b}\index{SerialPort.h@{SerialPort.h}!selectBaudRate@{selectBaudRate}}
\index{selectBaudRate@{selectBaudRate}!SerialPort.h@{SerialPort.h}}
\doxysubsubsection{\texorpdfstring{selectBaudRate()}{selectBaudRate()}}
{\footnotesize\ttfamily \label{_serial_port_8h_a127cadd593a5af64e10d94488978920b} 
DWORD select\+Baud\+Rate (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Prompts the user to select a baud rate for serial communication. 

This function displays a list of available baud rates (9600, 115200, 19200) and prompts the user to select one. The selected baud rate is returned as a DWORD value.

\begin{DoxyReturn}{Returns}
DWORD The baud rate selected by the user (e.\+g., CBR\+\_\+9600). 
\end{DoxyReturn}
\Hypertarget{_serial_port_8h_ad2b6dc672019e23dab7d591991aeaef1}\index{SerialPort.h@{SerialPort.h}!selectPort@{selectPort}}
\index{selectPort@{selectPort}!SerialPort.h@{SerialPort.h}}
\doxysubsubsection{\texorpdfstring{selectPort()}{selectPort()}}
{\footnotesize\ttfamily \label{_serial_port_8h_ad2b6dc672019e23dab7d591991aeaef1} 
wstring select\+Port (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Prompts the user to select a COM port. 

This function displays a list of available COM ports (COM1 to COM9) and prompts the user to select one by entering a number corresponding to the port. The selected port is returned as a wide string (e.\+g., L"{}\+COM1"{}).

\begin{DoxyReturn}{Returns}
wstring The COM port selected by the user (e.\+g., L"{}\+COM1"{}). 
\end{DoxyReturn}
\Hypertarget{_serial_port_8h_a7e10a8858a30f45b39bc1b18904c5a15}\index{SerialPort.h@{SerialPort.h}!sendMessage@{sendMessage}}
\index{sendMessage@{sendMessage}!SerialPort.h@{SerialPort.h}}
\doxysubsubsection{\texorpdfstring{sendMessage()}{sendMessage()}}
{\footnotesize\ttfamily \label{_serial_port_8h_a7e10a8858a30f45b39bc1b18904c5a15} 
void send\+Message (\begin{DoxyParamCaption}\item[{HANDLE}]{h\+Serial}{, }\item[{const string \&}]{message}{}\end{DoxyParamCaption})}



Sends a message to the serial port. 


\begin{DoxyParams}{Parameters}
{\em h\+Serial} & Handle to the serial port. \\
\hline
{\em message} & The message to send as a C-\/style string.\\
\hline
\end{DoxyParams}
This function writes the given message to the serial port. It uses the {\ttfamily Write\+File} function to send the data and waits for the specified message length to be written.


\begin{DoxyParams}{Parameters}
{\em h\+Serial} & Handle to the serial port. \\
\hline
{\em message} & The message to send as a C-\/style string. \\
\hline
\end{DoxyParams}
